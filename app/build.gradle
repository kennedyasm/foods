plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-kapt'
    id 'kotlin-android-extensions'
    id 'androidx.navigation.safeargs.kotlin'
    id 'com.google.android.libraries.mapsplatform.secrets-gradle-plugin'
}

android {
    Properties properties = new Properties()

    def keystorePropertiesFile = rootProject.file("keystore.properties")
    if (keystorePropertiesFile.exists()) {
        properties.load(keystorePropertiesFile.newDataInputStream())
    }

    namespace 'com.example.foods'
    compileSdk properties.getProperty("compile.sdk").toInteger()

    defaultConfig {
        applicationId "com.example.foods"

        minSdk properties.getProperty("min.sdk").toInteger()
        targetSdk properties.getProperty("target.sdk").toInteger()

        versionCode properties.getProperty("version.code").toInteger()
        versionName properties.getProperty("version.name")

        testInstrumentationRunner "com.example.foods.FoodRecipesTestRunner"
    }

    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            buildConfigField "String", "BASE_URL", properties.getProperty("base.url") ?: ""
            buildConfigField "String", "API_KEY", properties.getProperty("api.key") ?: ""
            buildConfigField "String", "SERVICES_PATH", properties.getProperty("services.path") ?: ""
        }
        debug {
            buildConfigField "String", "BASE_URL", properties.getProperty("base.url.debug") ?: ""
            buildConfigField "String", "API_KEY", properties.getProperty("api.key.debug") ?: ""
            buildConfigField "String", "SERVICES_PATH", properties.getProperty("services.path.debug") ?: ""
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    kotlinOptions {
        jvmTarget = '1.8'
    }

    viewBinding {
        enabled = true
    }
}

dependencies {
    androidTestImplementation androidTestDependencies.androidxJUnitTest
    androidTestImplementation androidTestDependencies.androidxEspressoTest

    implementation generalDependencies.retrofitGsonConverter
    implementation generalDependencies.okHttpLoginInterceptor
    implementation generalDependencies.retrofitAdapterRxJava
    implementation generalDependencies.reactivexRxAndroid
    implementation generalDependencies.androidxRoomRxJava3
    implementation generalDependencies.androidxRoomKtx

    testImplementation testDependencies.androidxArchCoreTest
    androidTestImplementation androidTestDependencies.androidxArchCoreTest

    implementation generalDependencies.dagger
    implementation generalDependencies.daggerAndroidSupport
    kapt generalDependencies.daggerAndroidProcessor
    kapt generalDependencies.daggerCompile


    kaptAndroidTest androidTestDependencies.daggerCompiler
    androidTestAnnotationProcessor androidTestDependencies.daggerCompiler

    implementation generalDependencies.glide
    annotationProcessor generalDependencies.glideCompiler

    // mockito test
    testImplementation testDependencies.mockitoCore
    implementation testDependencies.mockWebServer

    androidTestImplementation testDependencies.mockitoCore

    androidTestImplementation "androidx.test:runner:1.5.2"
    androidTestImplementation "androidx.test:rules:1.5.0"

    testImplementation "androidx.test:core:1.5.0"
    testImplementation "androidx.test:monitor:1.6.1"
    debugImplementation "androidx.test:monitor:1.6.1"


    androidTestImplementation "androidx.test.espresso:espresso-contrib:3.3.0"

    androidTestImplementation "androidx.test.uiautomator:uiautomator:2.2.0"

    androidTestImplementation "androidx.test.espresso.idling:idling-concurrent:3.3.0"

    androidTestImplementation "androidx.test.espresso:espresso-contrib:3.3.0"

    implementation 'com.jakewharton.timber:timber:5.0.1'

    // Kotlin
    implementation "androidx.navigation:navigation-fragment-ktx:2.5.3"
    implementation "androidx.navigation:navigation-ui-ktx:2.5.3"

    // Testing Navigation
    androidTestImplementation "androidx.navigation:navigation-testing:2.5.3"

    implementation "androidx.room:room-runtime:2.5.0"
    kapt "androidx.room:room-compiler:2.5.0"

    // optional - Test helpers
    testImplementation "androidx.room:room-testing:2.5.0"

    implementation 'com.google.android.gms:play-services-maps:18.1.0'

    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-android:1.6.4'

    testImplementation "org.jetbrains.kotlinx:kotlinx-coroutines-test:1.6.4"
    androidTestImplementation "org.jetbrains.kotlinx:kotlinx-coroutines-test:1.6.4"

    androidTestImplementation 'androidx.test.uiautomator:uiautomator:2.2.0'

}
